<h2 mat-dialog-title>{{ isEditMode ? 'Edit Connection' : 'New Connection' }}</h2>

<mat-dialog-content>
    <form [formGroup]="form">
        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Connection Name</mat-label>
            <input matInput formControlName="name" placeholder="e.g., Bloomberg API">
            <mat-error *ngIf="form.get('name')?.hasError('required')">Name is required</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Base URL</mat-label>
            <input matInput formControlName="baseUrl" placeholder="https://api.example.com/v1">
            <mat-error *ngIf="form.get('baseUrl')?.hasError('required')">Base URL is required</mat-error>
            <mat-error *ngIf="form.get('baseUrl')?.hasError('pattern')">Enter a valid URL (http:// or
                https://)</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Authentication Method</mat-label>
            <mat-select formControlName="authenticationMethod">
                <mat-option *ngFor="let method of authMethods" [value]="method">{{ method }}</mat-option>
            </mat-select>
            <mat-error *ngIf="form.get('authenticationMethod')?.hasError('required')">Authentication method is
                required</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Authentication Place</mat-label>
            <mat-select formControlName="authenticationPlace">
                <mat-option *ngFor="let place of authPlaces" [value]="place">{{ place }}</mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Key Field</mat-label>
            <input matInput formControlName="keyField" placeholder="e.g., X-API-Key or Authorization">
            <mat-error *ngIf="form.get('keyField')?.hasError('required')">Key field is required</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Value Field (Optional, cannot be changed after creation)</mat-label>
            <input matInput formControlName="valueField" placeholder="e.g., your_api_key_here">
            <mat-hint *ngIf="isEditMode">Value is set but hidden for security</mat-hint>
        </mat-form-field>

        <mat-checkbox formControlName="isDefault" class="checkbox-field">Set as Default Connection</mat-checkbox>
    </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()">Cancel</button>
    <button mat-raised-button color="primary" (click)="onSubmit()" [disabled]="!form.valid">
        {{ isEditMode ? 'Update' : 'Create' }}
    </button>
</mat-dialog-actions>